
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Athena Payment Porthole</title>
  <style>
    body {font-family: Arial, sans-serif; background:#f7f9fc; margin:0;}
    header {background:#003366; color:#fff; padding:20px 0; text-align:center;}
    h1 {margin:0; font-size:28px;}
    .container {max-width:420px; margin:40px auto; background:#fff; padding:24px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,.06);}
    label {display:block; font-weight:600; margin-bottom:8px;}
    input[type="email"]{width:100%; padding:12px; font-size:16px; border:1px solid #ccd; border-radius:6px; margin-bottom:16px;}
    button{width:100%; padding:14px; font-size:18px; border:none; border-radius:6px; background:#28a745; color:#fff; cursor:pointer;}
    button:disabled{opacity:.7; cursor:not-allowed;}
    .note{font-size:12px; color:#666; margin-top:10px;}
    footer{color:#666; text-align:center; font-size:14px; margin:28px 0;}
  </style>
</head>
<body>
  <header><h1>Athena Payment Porthole</h1></header>
  <div class="container">
    <form id="payForm">
      <label for="email">Enter Your Email</label>
      <input type="email" id="email" name="email" placeholder="you@example.com" required />
      <button id="payBtn" type="submit">Pay With Square</button>
      <div class="note">We’ll email you a receipt + invoice after payment.</div>
    </form>
  </div>
  <footer>© 2025 Today’s Marketing Solutions LLC</footer>

  <script>
    const SQUARE_LINK = "https://square.link/u/OxAkk7Zz?src=sheet"; // your live link
    const WEBHOOK_TRACK = "https://YOUR-REPL-URL/incoming"; // replace with your Replit/Zapier/Make webhook URL

    document.getElementById('payForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const btn = document.getElementById('payBtn');
      const email = document.getElementById('email').value.trim();
      if(!email){ alert("Please enter a valid email."); return; }
      btn.disabled = true; btn.textContent = "Saving…";

      try {
        // Store email intent BEFORE redirecting to Square
        await fetch(WEBHOOK_TRACK, {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({
            event: "checkout_intent",
            email,
            ts: new Date().toISOString(),
            source: "athena-portal"
          })
        });
      } catch (err) {
        // Even if logging fails, still allow checkout to proceed
        console.warn("Pre-log failed, continuing to Square:", err);
      }

      window.location.href = SQUARE_LINK;
    });
  </script>
</body>
</html>
